<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>ใบเสร็จคำสั่งซื้อ</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .receipt { border: 1px solid #000; padding: 20px; }
        .receipt h1, .receipt h2 { text-align: center; }
        .receipt table { width: 100%; border-collapse: collapse; }
        .receipt th, .receipt td { border: 1px solid #000; padding: 8px; text-align: left; }
        .receipt th { background-color: #f2f2f2; }
        .receipt .total { text-align: right; font-size: 1.2em; }
    </style>
</head>
<body>
    <div class="receipt">
        <h1>ใบเสร็จคำสั่งซื้อ</h1>
        <h2>ข้อมูลคำสั่งซื้อ</h2>
        <p><strong>หมายเลขคำสั่งซื้อ:</strong> {{ order.id }}</p>
        <p><strong>สถานะคำสั่งซื้อ:</strong> {{ order.get_order_status_display }}</p>
        <p><strong>วันที่สั่งซื้อ:</strong> {{ order.order_date|date:"d/m/Y H:i" }}</p>
        <p><strong>วิธีการจัดส่ง:</strong> {{ order.get_shipping_method_display }}</p>
        <p><strong>หมายเลขติดตาม:</strong> {{ order.tracking_number }}</p>
        
        <h2>รายการสินค้า</h2>
        <table>
            <thead>
                <tr>
                    <th>สินค้า</th>
                    <th>จำนวน</th>
                    <th>ราคา</th>
                </tr>
            </thead>
            <tbody>
                {% for item in order_items %}
                <tr>
                    <td>{{ item.product.name }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>{{ item.product.price }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <p class="total"><strong>ราคารวมสินค้า:</strong> {{ total_price }}</p>
        <p class="total"><strong>ค่าจัดส่ง:</strong> {{ shipping_fee }}</p>
        <p class="total"><strong>ราคารวมทั้งหมด:</strong> {{ total_price_with_shipping }}</p>
        
        {% if payment_uploads %}
        <h2>รายละเอียดการชำระเงิน</h2>
        {% for payment in payment_uploads %}
            <p><strong>ชื่อผู้ชำระ:</strong> {{ payment.name }}</p>
            <p><strong>จำนวนเงิน:</strong> {{ payment.amount }}</p>
            <p><strong>เบอร์โทรศัพท์:</strong> {{ payment.phone }}</p>
            <p><strong>เวลาที่โอน:</strong> {{ payment.transfer_time|date:"d/m/Y H:i" }}</p>
            {% if payment.payment_slip %}
            <p><strong>หลักฐานการโอน:</strong></p>
            <img src="{{ payment.payment_slip.url }}" alt="Payment Slip" style="width: 200px;">
            {% endif %}
        {% endfor %}
        {% endif %}
        
        {% if order.delivery_method == 'delivery' %}
        <h2>ที่อยู่ในการจัดส่ง</h2>
        <p><strong>ถนน:</strong> {{ address.street }}</p>
        <p><strong>เขต/อำเภอ:</strong> {{ address.district }}</p>
        <p><strong>จังหวัด:</strong> {{ address.city }}</p>
        <p><strong>รหัสไปรษณีย์:</strong> {{ address.postal_code }}</p>
        {% endif %}
    </div>
</body>
</html>
